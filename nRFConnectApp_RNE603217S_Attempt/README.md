# Azure-Pacemaker-Attack

Sniffering tool: Adafruit Bluefruit LE Friend (unstable, not always be able to capture/ capture all packets :-()

Analysis tool: Wireshark

Analysis target: Azure pacemaker RNE603217S, nRF Connect App

**All the .pcapng files could only be viewed using Wireshark**

**The 'master' means the mobile phone App, the 'slave' means the pacemaker**

## Files Description:

- The file **'Azure3217 Attribute Table'** in the root directory contains the attribute table of the pacemaker.

- The capturing file **'nRFConnectApp_RNE603217S_Sniff'** contains the packets when using a general-used iOS App 'nRF Connect' to connect with the pacemaker. It shows that although a general master could connect with the pacemaker, it is not permitted to retrieve the patient info from the pacemaker. The connection will crash automatically after the 'discovery process', during which the master gets the GATT info (attribute table) from the slave device.

  It's quite interesting that:
1. There is one extra characteristic declearation and one extra descriptor found whose attribute handles are 0x001D and 0x001F respectively (they were not found in the communications between pacemaker and Medtronic App). 
2. Another difference is that the general-used App didn't write data into the attributes 0x0016 and 0x0019 (two CCC descriptors) to trigger the Notification and Indication respectively, although it writes data into descriptor 0x000F to trigger Indication (This is GATT service so it might be unimportant). And absolutely, nothing is written into the characteristic value attribute 0x0012. As for communication between the Medtronic App and pacemaker, data has been written into both descriptors (0x0016, 0x0019) so that the Notification and Indication of attributes 0x0015 and 0x0018 could work. 






