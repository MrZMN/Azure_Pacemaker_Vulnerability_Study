# Azure-Pacemaker-Attack

Sniffering tool: Adafruit Bluefruit LE Friend
Analysis tool: Wireshark

PS. All the .pcapng files could only be viewed using Wireshark

The capturing file 'Azure pacemaker Packets_generalApp' contains the packets info when using a general-used iOS App 'nRF Connect' to connect with the pacemaker. It shows that a general master is not permitted to retrieve the info from the pacemaker, and the connection will break automatically after the 'discovery process', during which the master gets the GATT info from the slave device.

The capturing files (starting with 'Azure pacemaker Packests') contain the communication info when using the Medtronic 'MyCareLink Heart' App to connect with the pacemaker. The connection could be triggered using the 'Send Transmission' function of the App. Although lots of attempts, not all of them contain all the communication info (such as losing some specific packets), probably because of the limitation of the sniffering tool. However, they all show that the connection between the Medtronic App and pacemaker is complete. By analysing the packets, the attribute table of the pacemaker could be generated (See file 'Azure3217 attribute table'). 

0x0015: It seems that the attribute 0x0015 contains the patient info, such as heart rate. Because during the communication this attribute keeps notifying ('Notification' is one kind of operation in BLE. The info is sent from slave to master in one direction). 

0x0012: It's assumed that something is written into the attribute 0x0012 to trigger the notification processes, because such Write operations only occur in the communications between Medtronic App and pacemaker. 

0x0018: For attribute 0x0018, it sends an Indication ('Indication' is one kind of operation in BLE. Similar with Notification, its from slave to master. However, a Confirmation is required from master to slave when the master receives the Indication) before the Notifications start to be transmitted. It also occurs in the end of the communication, exactly before the final 'LL_TERMINATE_IND'. 

0x001B: Besides, some info(different in each time, 9 bytes, but only the first byte is not 0x00) keeps being written into the attribute 0x001B regularly throughtout the whole Notification procedure (hundreds of Notifications sent to the master). 

It also shows that one 'Send Transmission' function will trigger two connections between the pacemaker and the Medtronic App. These two connections happen in two different advertising intervals, in most cases in two consecutive intervals (3 mins advertising interval). The structures of these two communications are nearly the same, except for that there're only two Notifications packets in the second communication.

