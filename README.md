# Vulnerability Study of Medtronic Azure Pacemaker
This repository backups the experimental processes of the Medtronic pacemaker attack project.

Attacked Devices: two Medtronic Azure XT SR MRI SureScan pacemakers (Sequence Number: RNE603217S; RNE606526S), cf. https://europe.medtronic.com/xd-en/healthcare-professionals/products/cardiac-rhythm/pacemakers/azure.html; 
<div align=center><img width="300" height="300" src="https://github.com/MrZMN/Azure-Pacemaker-Attack/blob/master/IMG/Pacemakers.jpg"/></div>
Dialog DA14580 SoC (the underlying SoC of the Azure pacemaker), cf. https://uk.farnell.com/dialog-semiconductor/da14580devkt-b/dev-board-bluetooth-low-energy/dp/2729282
<div align=center><img width="300" height="300" src="https://github.com/MrZMN/Azure-Pacemaker-Attack/blob/master/IMG/DA14580%20Development%20Kit%20-%20Basic.jpg"/></div>

Apps: Medtronic MyCareLink, nRF Connect (a general Bluetooth App)

## Experimental Design:

1. Sniff the communication between the pacemaker and the official MyCareLink App (they need to be pre-bonded in the hospital). Reverse engineer the protocol and see how patient data is retrieved. The sniffing recordings and corresponding analysis are stored in the *MyCareLinkApp_RNE603217S_Connect* directory.

2. Connect the pacemaker with the nRF Connect App, and see the difference between the communications of step 2 and step 1. The recordings and analysis are stored in the *nRFConnectApp_RNE603217S_Attempt* directory.

3. Based on SweynTooth tool (cf. https://github.com/Matheus-Garbelini/sweyntooth_bluetooth_low_energy_attacks), apply buffer overflow attack on both Dialog DA14580 SoC and Azure pacemaker. See what the buffer overfolw attack triggers on them. The relevant results are stored in the directory *BufferOverflow_RNE606526S*. And if possible, find more similar and general vulnerabilities on these devices.

4. According to the sniffing details, the attribute table of the pacemakers is obtained. See the file *Azure RNE603217S Attribute Table.xlsx* 

5. After studying the logic of the Azure pacemaker, we went to the hospital and tried to sniff the whole protocol - including the 175kHz key exchange and the latter BLE encrypted communications. Unfortunately, we were only able to sniff the BLE details. The relevant results are stored in the directory *Programmer_Pacemakers_ConnectAndProgram*. 

6. Relevant device manuals are stored in the *Device Manuals* directory.
