# Azure RNE606526S, RNE603217S && Programmer - Connection and Programming

Sniffering target: Azure pacemaker RNE606526S, RNE603217S; Programmer (only available in the hospital)

Sniffering tool: Adafruit Bluefruit LE Friend 

Analysis tool: Wireshark

**All the .pcapng files can be viewed directly using Wireshark**

## Files Description:

- '090320_RNE603217S_1_DoNothing' and '090320_RNE603217S_2_DoNothing' record 2 sniffing processes between the Azure RNE603217S and the programmer in the hospital. In both processes, we just connected the pacemaker with the programmer, then stopped the connection after a while, doing nothing in the middle. The number 1 or 2 denotes the operation order.

- The rest of the files record 3 sniffing processes between the Azure RNE606526S and the programmer. In '090320_RNE606526S_1_DoNothing' and '090320_RNE606526S_3_DoNothing', we did nothing in the middle, just like the operation mentioned above. In '090320_RNE606526S_2_SetNameAsA', we connected the devices, then used the programmer to set the pacemaker's name as 'A', then stopped the connection. The number 1, 2 or 3 denotes the operation order.

- We went to the hospital for two times. At the first time, we used the programmer to connect with the pacemaker RNE603217S, and there was a firmware update process. Therefore, at the second time when we went to the hospital, we expected there would also be a firmwire update process happening at pacemaker 'RNE606526S'. However, nothing special happened.

- We noticed that all the information was encrypted after the programmer connecting with the pacemaker. Therefore, we only tried one function in the programmer, which is changing the pacemaker's name. 

## Suspections:

As we know, the BLE protocol itself contains an encryption & bonding procedure. In the encryption process, one of the security levels is to exchange a short-term key through an Out-of-band (OOB) channel, then use it to distribute a long-term key to encrypt the whole session. In the hospital, in order to program the pacemaker, the programmer needs to stay very close to the pacemaker for a while, then a secure BLE session can be established between them. We suspect that the short-term-key is agreed in the 'close contact process' using a 175 kHz short range communication (This frequency is obtained in the programmer manuals, besides, this is also applied in some other models of IMDs). This requires further reverse engineering works in the hospital to verify our ideas.   
